<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç URL –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #1a1a1a;
            color: #0f0;
        }
        .test-block {
            background: #000;
            border: 1px solid #0f0;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        h2 {
            color: #0ff;
            margin-top: 20px;
        }
        .success { color: #0f0; }
        .error { color: #f00; }
        .warning { color: #ff0; }
        pre {
            background: #000;
            padding: 10px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</h1>
    
    <div class="test-block">
        <h2>1. –ü–æ–ª–Ω—ã–π URL:</h2>
        <pre id="fullUrl"></pre>
    </div>
    
    <div class="test-block">
        <h2>2. Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:</h2>
        <pre id="queryParams"></pre>
    </div>
    
    <div class="test-block">
        <h2>3. –ü–∞—Ä–∞–º–µ—Ç—Ä video_url (–∫–∞–∫ –ø—Ä–∏—à—ë–ª):</h2>
        <pre id="rawVideoUrl"></pre>
    </div>
    
    <div class="test-block">
        <h2>4. –ü–∞—Ä–∞–º–µ—Ç—Ä video_url (–¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π):</h2>
        <pre id="decodedVideoUrl"></pre>
    </div>
    
    <div class="test-block">
        <h2>5. Telegram WebApp –¥–∞–Ω–Ω—ã–µ:</h2>
        <pre id="tgData"></pre>
    </div>
    
    <div class="test-block">
        <h2>6. –†–µ–∑—É–ª—å—Ç–∞—Ç:</h2>
        <div id="result"></div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();
        
        // –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
        const urlParams = new URLSearchParams(window.location.search);
        const rawVideoUrl = urlParams.get('video_url');
        const decodedVideoUrl = rawVideoUrl ? decodeURIComponent(rawVideoUrl) : null;
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
        document.getElementById('fullUrl').textContent = window.location.href;
        document.getElementById('queryParams').textContent = window.location.search || '(–Ω–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)';
        document.getElementById('rawVideoUrl').textContent = rawVideoUrl || '(–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç)';
        document.getElementById('decodedVideoUrl').textContent = decodedVideoUrl || '(–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç)';
        
        // Telegram –¥–∞–Ω–Ω—ã–µ
        const tgInfo = {
            platform: tg.platform,
            version: tg.version,
            colorScheme: tg.colorScheme,
            user: tg.initDataUnsafe?.user || null
        };
        document.getElementById('tgData').textContent = JSON.stringify(tgInfo, null, 2);
        
        // –†–µ–∑—É–ª—å—Ç–∞—Ç
        const resultDiv = document.getElementById('result');
        if (!rawVideoUrl) {
            resultDiv.innerHTML = '<span class="error">‚ùå –û–®–ò–ë–ö–ê: –ü–∞—Ä–∞–º–µ—Ç—Ä video_url –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ URL!</span>';
        } else if (!decodedVideoUrl) {
            resultDiv.innerHTML = '<span class="error">‚ùå –û–®–ò–ë–ö–ê: –ù–µ —É–¥–∞–ª–æ—Å—å –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å video_url!</span>';
        } else if (decodedVideoUrl.includes('dog')) {
            resultDiv.innerHTML = '<span class="warning">‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: URL —Å–æ–¥–µ—Ä–∂–∏—Ç "dog" (—Ç–µ—Å—Ç–æ–≤–æ–µ –≤–∏–¥–µ–æ)</span>';
        } else if (decodedVideoUrl.startsWith('http')) {
            resultDiv.innerHTML = '<span class="success">‚úÖ OK: URL –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ!</span>';
        } else {
            resultDiv.innerHTML = '<span class="warning">‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: URL –Ω–µ –ø–æ—Ö–æ–∂ –Ω–∞ HTTP —Å—Å—ã–ª–∫—É</span>';
        }
        
        // –õ–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª—å
        console.log('=== DIAGNOSTIC TEST ===');
        console.log('Full URL:', window.location.href);
        console.log('Query:', window.location.search);
        console.log('Raw video_url:', rawVideoUrl);
        console.log('Decoded video_url:', decodedVideoUrl);
        console.log('Telegram WebApp:', tgInfo);
    </script>
</body>
</html>

